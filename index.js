const mainForm=document.querySelector("#main-form"),API_ENDPOINT="https://buildforsdg-covid19-estimator.herokuapp.com/api/v1/on-covid-19",showLoadingGif=(e=!0)=>{e?(document.querySelector(".report-card").classList.remove("show"),document.querySelector(".error-card").classList.remove("show"),document.querySelector("#loading-gif").style.display="block"):document.querySelector("#loading-gif").style.display="none"},displayResults=e=>{const r={currentlyInfected:"Currently Infected",infectionsByRequestedTime:"Total Infections",severeCasesByRequestedTime:"Severe Cases",hospitalBedsByRequestedTime:"Available Hospital Beds",casesForICUByRequestedTime:"Cases for ICU",casesForVentilatorsByRequestedTime:"Cases for Ventilators",dollarsInFlight:"Dollars in Flight"};["impact","severeImpact"].forEach(a=>{const o=e[a],t=Object.entries(o).reduce((e,[a,o])=>`${e} <p class="card-text"><span class="font-weight-bold">${r[a]}:</span> <span class="float-right">${o.toLocaleString()}</span></p>`,"");document.querySelector(`#${a}-card .card-body`).innerHTML=t}),document.querySelector(".report-card").classList.add("show"),document.querySelector(".report-card").scrollIntoView()},displayError=e=>{document.querySelector(".error-card .card-body").innerHTML=`<p class="card-text">${e}</p>`,document.querySelector(".error-card").classList.add("show"),document.querySelector(".error-card").scrollIntoView()},displayValidationError=e=>{const r=Object.entries({"region.name":"Country","region.avgAge":"Average Age","region.avgDailyIncomeInUSD":"Average Daily Income","region.avgDailyIncomePopulation":"Average Income Population",periodType:"Duration Type",timeToElapse:"Duration",reportedCases:"Reported Cases",population:"Population",totalHospitalBeds:"Total Hospital Beds"}).reduce((r,[a,o])=>{const t=a.split(".");if(t.length>1&&e[t[0]][t[1]]){return`${r} <p class="card-text">${e[t[0]][t[1]].toString().replace(t[1],o)}</p>`}if(e[t[0]]&&1===t.length){return`${r} <p class="card-text">${e[t[0]].toString().replace(t[0],o)}</p>`}return r},"");document.querySelector(".error-card .card-body").innerHTML=r,document.querySelector(".error-card").classList.add("show"),document.querySelector(".error-card").scrollIntoView()},handleResponse=async e=>{let r;switch(e.status){case 200:r=await e.json(),displayResults(r);break;case 400:r=await e.json(),displayValidationError(r);break;default:r=await e.text(),displayError(r)}},postInputData=async e=>{showLoadingGif();try{const r=await fetch(API_ENDPOINT,{body:JSON.stringify(e),method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"}});await handleResponse(r)}catch(e){displayError(e.message)}showLoadingGif(!1)};mainForm.addEventListener("submit",e=>{e.preventDefault();const r={region:{name:mainForm.querySelector("[data-region-name]").value,avgAge:Number(mainForm.querySelector("[data-avg-age]").value),avgDailyIncomeInUSD:Number(mainForm.querySelector("[data-avg-income]").value),avgDailyIncomePopulation:Number(mainForm.querySelector("[data-avg-population]").value/100)},periodType:mainForm.querySelector("[data-period-type]").value,timeToElapse:Number(mainForm.querySelector("[data-time-to-elapse]").value),reportedCases:Number(mainForm.querySelector("[data-reported-cases]").value),population:Number(mainForm.querySelector("[data-population]").value),totalHospitalBeds:Number(mainForm.querySelector("[data-total-hospital-beds]").value)};postInputData(r)});